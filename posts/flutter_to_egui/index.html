<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="https://raw.githubusercontent.com/jdiaz97/greenblog/refs/heads/gh-pages/css/franklin.css"> <link rel=stylesheet  href="https://raw.githubusercontent.com/jdiaz97/greenblog/refs/heads/gh-pages/css/basic.css"> <link rel=icon  href="https://raw.githubusercontent.com/jdiaz97/greenblog/refs/heads/gh-pages/assets/favicon.png"> <title>Why I Switched from Flutter &#43; Rust to Rust &#43; egui</title> <header> <div class=blog-name ><a href="/"></a>Greenblog</div> <nav> <ul> <li><a href="/">Home</a> </ul> <img src="https://raw.githubusercontent.com/jdiaz97/greenblog/refs/heads/gh-pages/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content > <h1 id=why_i_switched_from_flutter_rust_to_rust_egui ><a href="#why_i_switched_from_flutter_rust_to_rust_egui" class=header-anchor >Why I Switched from Flutter &#43; Rust to Rust &#43; egui</a></h1> <div class=franklin-toc ><ol><li><a href="#why_i_switched_from_flutter_rust_to_rust_egui">Why I Switched from Flutter &#43; Rust to Rust &#43; egui</a><ol><li><a href="#introduction">Introduction</a><ol><li><a href="#flutter_rust">Flutter &#43; Rust</a></ol><li><a href="#rust_egui">Rust &#43; egui</a><li><a href="#minimizing_complexity">Minimizing complexity</a><li><a href="#playing_to_my_strengths">Playing to my strengths</a><li><a href="#immediate_mode_is_a_great_paradigm_for_ui">Immediate mode is a great paradigm for UI</a><li><a href="#performance">Performance</a><li><a href="#anyway">Anyway</a></ol></ol></div> <h2 id=introduction ><a href="#introduction" class=header-anchor >Introduction</a></h2> <p>This is just a personal experience, there are no absolute truths. Like in any other blog post, a lot of the things you&#39;ll read here could be just a skill issue, or legitimate issues. It&#39;s up to you to decide.</p> <h3 id=flutter_rust ><a href="#flutter_rust" class=header-anchor >Flutter &#43; Rust</a></h3> <p>We had an app that had a nice Flutter UI that called Rust binaries. The bindings were generated using <a href="https://github.com/fzyzcjy/flutter_rust_bridge">flutter&#95;rust&#95;bridge</a>, which is an amazing piece of software. A lot of people have built large and complex apps using this tool. It&#39;s crazy how far it can just work, just by running:</p> <pre><code class="plaintext hljs">flutter_rust_bridge_codegen generate</code></pre>
<p>That&#39;s really all it takes for many, many, many cases.</p>
<h3 id=rust_egui ><a href="#rust_egui" class=header-anchor >Rust &#43; egui</a></h3>
<p>After some time of being frustrated with the current stack, I was thinking of dropping Flutter; I didn&#39;t want to think about FFI anymore. I chose <a href="https://github.com/emilk/egui">egui</a> to check if it was feasible to move the UI code with very little friction. I came to know about egui because of the extremely impressive work they&#39;ve done to build <a href="https://github.com/rerun-io/rerun">rerun</a>. I was very motivated to try this.</p>
<p>After rewriting most of the UI code in egui during a weekend, I decided to move and leave Flutter behind. But why?</p>
<h2 id=minimizing_complexity ><a href="#minimizing_complexity" class=header-anchor >Minimizing complexity</a></h2>
<p>Having 2 programming languages adds complexity. BoquilaHUB is a small software project, I don&#39;t want it to have unnecessary complexity.</p>
<p>Not all complexity is unnecessary, you do sometimes need it in order to make progress and get things done. So, how much complexity is unnecessary complexity?</p>
<p>We can measure this by looking at lines of code. In my case, &#39;flutter<em>rust</em>bridge_codegen generate&#39; will generate a few thousand lines of code. I don&#39;t understand this generated code, it&#39;s not readable. Do I really want to have some code I don&#39;t understand in my project folder? In earlier versions of the project, sometimes the amount of generated lines would be higher than the lines written by me. This balance would change depending on the API, but it&#39;s always quite big.</p>
<p>I want to understand my project, I want to understand what I&#39;m compiling. I can&#39;t optimize generated lines that aren&#39;t readable and will change in mysterious ways when I change the API.</p>
<h2 id=playing_to_my_strengths ><a href="#playing_to_my_strengths" class=header-anchor >Playing to my strengths</a></h2>
<p>There is only 1 programmer in the project, and that&#39;s me. We &#40;Boquila&#41; were hoping to get funding to get an actually good GUI person who could make great use of Flutter to create a wonderful GUI experience. That didn&#39;t happen, so the Flutter capabilities were very underused.</p>
<p>Flutter:</p>

    <img src="/assets/flutter_rust.jpg" style="height: 500px; width: auto;">

<p>Egui:</p>

    <img src="/assets/flutter_rust2.jpg" style="height: 500px; width: auto;">

<p>Of course, making the Flutter one look good is possible and easy if you&#39;re good at it. I wasn&#39;t, and egui just worked better for me. I didn&#39;t even make an effort to make it look good; I just grabbed a minimal template and modified it, and it looks great.</p>
<h2 id=immediate_mode_is_a_great_paradigm_for_ui ><a href="#immediate_mode_is_a_great_paradigm_for_ui" class=header-anchor >Immediate mode is a great paradigm for UI</a></h2>
<p>A quick Google search with &quot;flutter setstate is not refreshing&quot; reveals a struggle that you will face quite often when running Flutter. It sounds like an easy fix, but the nature of Flutter using a bunch of nested Widgets creates, naturally, lasagna code that makes it hard to reason about this.</p>
<p>When moving to egui, I recreated the whole UI with 0 cases of this problem. It&#39;s a different paradigm, every frame the UI will refresh, so you don&#39;t have to struggle. You don&#39;t have to make complex callbacks or deal with state management frameworks like getx, provider, bloc, or whatever else there is. If you work with the paradigm and not against it, you&#39;re done.</p>
<p>Do you need to add a button? In Rust:</p>
<pre><code class="plaintext hljs">if ui.button(&quot;click me&quot;).clicked() {
    self.did_user_click = true;
}</code></pre>
<p>That&#39;s it, you will 100&#37; see the change in your UI, no callbacks, no stateful vs stateless widgets, no googling why your UI is not refreshing.</p>
<h2 id=performance ><a href="#performance" class=header-anchor >Performance</a></h2>
<p>This is not about Rust being fast and Dart being slow. It&#39;s about my personal appreciation that the final app in 100&#37; Rust was faster. The previous slowness maybe was a side effect of having unmonitored FFIâ€”how much was I cloning? I don&#39;t know.</p>
<p>The app calls ONNX Runtime, which is written in C. This is called from Rust using <a href="https://github.com/pykeio/ort">ort</a>, and before, Dart would call these binaries to let me do the inference in Flutter. Maybe all of this made the app drag a bit.</p>
<p>Now it just feels faster and way more snappy.</p>
<h2 id=anyway ><a href="#anyway" class=header-anchor >Anyway</a></h2>
<p>That&#39;s it. If you fancy AI for biodiversity, feel free to support <a href="https://github.com/boquila/boquilahub/">BoquilaHUB</a> at this <a href="https://boquila.org/donate">link</a>.</p>
<div class=page-foot >
</div>
</div>
    
    
        <script src="/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>